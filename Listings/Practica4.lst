A51 MACRO ASSEMBLER  PRACTICA4                                                            07/08/2021 09:15:11 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\Practica4.obj
ASSEMBLER INVOKED BY: D:\Keil_v5\C51\BIN\A51.EXE Practica4.a51 SET(SMALL) DEBUG PRINT(.\Listings\Practica4.lst) OBJECT(.
                      \Objects\Practica4.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     ;PRACTICA 4
                       2     ;P2: BUS DE DATOS DE LCD
                       3     ;P1.4: RS - LCD
                       4     ;P1.5: E - LCD
                       5     
                       6     ;P1:3 - P1.0: D - A DE 74C922
                       7     
                       8     ;P3.1: PUERTO SERIAL
                       9     ;P3.2: ASCII MODE
                      10     ;P3.3: LECTURA DE MATRIZ
                      11     
                      12     ;TIMER 1 - DELAY 100 us
                      13     
                      14     ;R7: N VECES QUE SE REPITE TIMER 100 uS
                      15     ;R6: CANTIDAD DE CARACTERES 
                      16     ;R5: CARACTER PRUEBA
                      17     
0000                  18     ORG 0H
0000 803E             19             SJMP START
                      20             
0040                  21     ORG 40H
0040                  22             START:
                      23     ;CONF TIMER
                      24     ;                               T1                                      T0      
                      25     ;                       GATE !T/C M1 M0         GATE !T/C M1 M0 
0040 758911           26             MOV TMOD, #00010001b
                      27             
0043 1150             28             ACALL LCD_INICIALIZATION
0045 7D41             29             MOV R5, #'A'
                      30             
0047                  31     TEST:
0047 ED               32             MOV A, R5
0048 117F             33             ACALL LCD_WRITE
004A 0D               34             INC R5
004B BD5AF9           35             CJNE R5, #'Z', TEST
                      36             
004E 80FE             37             SJMP $
                      38             
                      39             
0050                  40     LCD_INICIALIZATION:
                      41             ;38H - 39 us, RS = 0
                      42             ;0FH - 39 us, RS = 0
                      43             ;01H - 1.53 ms, RS = 0
0050 C294             44             CLR P1.4; !COMANDO / DATO
0052 75A038           45             MOV P2, #38H
0055 7F01             46             MOV R7, #01h
0057 D295             47             SETB P1.5 ; E 
0059 11A2             48             ACALL DELAY
005B C295             49             CLR P1.5; E
                      50             
005D 75A038           51             MOV P2, #38H
0060 7F01             52             MOV R7, #01h
0062 D295             53             SETB P1.5 ; E 
0064 11A2             54             ACALL DELAY
0066 C295             55             CLR P1.5; E
                      56             
0068 75A00F           57             MOV P2, #0FH
A51 MACRO ASSEMBLER  PRACTICA4                                                            07/08/2021 09:15:11 PAGE     2

006B 7F01             58             MOV R7, #01h
006D D295             59             SETB P1.5 ; E 
006F 11A2             60             ACALL DELAY
0071 C295             61             CLR P1.5; E
                      62             
0073 75A00F           63             MOV P2, #0FH
0076 7F10             64             MOV R7, #16D
0078 D295             65             SETB P1.5 ; E 
007A 11A2             66             ACALL DELAY
007C C295             67             CLR P1.5; E     
                      68     
007E 22               69             RET
                      70             
007F                  71     LCD_WRITE:
                      72     ;PARA ESCRIBIR EN LCD, PASAR AL ACC EL CARACTER A ESCRIBIR
007F BE1004           73             CJNE R6, #16D, LCD_WRITE_ACC
0082 1194             74             ACALL LCD_JUMP
0084 7E00             75             MOV R6, #0H
                      76             
0086                  77     LCD_WRITE_ACC:
0086 D294             78             SETB P1.4; !COMANDO / DATO
0088 F5A0             79             MOV P2, A; MOVER AL BUS DE LA PANTALLA EL DATO
008A D295             80             SETB P1.5; E
008C 7F01             81             MOV R7, #1
008E 11A2             82             ACALL DELAY
0090 C295             83             CLR P1.5
0092 0E               84             INC R6
                      85     
0093 22               86             RET
                      87             
0094                  88     LCD_JUMP:
0094 C294             89             CLR P1.4
0096 75A0C0           90             MOV P2, #0C0H
0099 D295             91             SETB P1.5
009B 7F01             92             MOV R7, #1D
009D 11A2             93             ACALL DELAY
009F C295             94             CLR P1.5
00A1 22               95             RET
                      96             
00A2                  97     DELAY:
00A2 758CFF           98             MOV TH0, #HIGH(-100)
00A5 758A9C           99             MOV TL0, #LOW(-100)
00A8 D28C            100             SETB TR0
                     101             
00AA                 102     POOLING:
00AA 308DFD          103             JNB TF0, POOLING
00AD C28D            104             CLR TF0
                     105             
00AF DFF1            106             DJNZ R7, DELAY
                     107             
00B1 22              108             RET
                     109             
00B2 80FE            110             SJMP $
                     111             END
A51 MACRO ASSEMBLER  PRACTICA4                                                            07/08/2021 09:15:11 PAGE     3

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

DELAY. . . . . . .  C ADDR   00A2H   A   
LCD_INICIALIZATION  C ADDR   0050H   A   
LCD_JUMP . . . . .  C ADDR   0094H   A   
LCD_WRITE. . . . .  C ADDR   007FH   A   
LCD_WRITE_ACC. . .  C ADDR   0086H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
POOLING. . . . . .  C ADDR   00AAH   A   
START. . . . . . .  C ADDR   0040H   A   
TEST . . . . . . .  C ADDR   0047H   A   
TF0. . . . . . . .  B ADDR   0088H.5 A   
TH0. . . . . . . .  D ADDR   008CH   A   
TL0. . . . . . . .  D ADDR   008AH   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
