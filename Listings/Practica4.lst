A51 MACRO ASSEMBLER  PRACTICA4                                                            07/12/2021 07:52:05 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\Practica4.obj
ASSEMBLER INVOKED BY: D:\Keil_v5\C51\BIN\A51.EXE Practica4.a51 SET(SMALL) DEBUG PRINT(.\Listings\Practica4.lst) OBJECT(.
                      \Objects\Practica4.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     ;PRACTICA 4
                       2     ;P2: BUS DE DATOS DE LCD
                       3     ;P1.4: RS - LCD
                       4     ;P1.5: E - LCD
                       5     
                       6     ;P1:3 - P1.0: D - A DE 74C922
                       7     
                       8     ;P3.1: PUERTO SERIAL
                       9     ;P3.2: LECTURA DE MATRIZ
                      10     ;P3.3: ASCII MODE
                      11     
                      12     ;TIMER 1 - DELAY 100 us
                      13     
                      14     ;R7: N VECES QUE SE REPITE TIMER 100 uS
                      15     ;R6: CANTIDAD DE CARACTERES impresos (LCD)
                      16     ;R5: CARACTER PRUEBA
                      17     
  0060                18     DIR_DATOS equ 60H
  0050                19     DIR_CONVERTION equ 50H
  00B6                20     RS equ P3.6
  00B7                21     E equ P3.7
                      22     
0000                  23     ORG 0H
0000 803E             24             SJMP START
                      25             
                      26     ;EXTERNAL 0
0003                  27     ORG 0003H
0003 32               28     RETI
                      29             
                      30     ;TIMER 0
000B                  31     ORG 000BH
000B 32               32     RETI
                      33     
                      34     ;EXTERNAL 1
0013                  35     ORG 0013H
0013 32               36     RETI
                      37     
                      38     ;TIMER 1
001B                  39     ORG 001BH
001B 32               40     RETI
                      41     
                      42     ;SERIAL PORT
0023                  43     ORG 0023H
0023 32               44     RETI
                      45             
                      46     
0040                  47     ORG 40H
0040                  48     START:
                      49     ;CONF TIMER
                      50     ;                               T1                                      T0      
                      51     ;                       GATE !T/C M1 M0         GATE !T/C M1 M0 
0040 758911           52             MOV TMOD, #00010001b
                      53             
                      54     ;CONF INTERRUPCIONES
                      55     ;               EA - ET2 ES ET1 EX1 ET0 EX0
0043 75A895           56     MOV IE, #10010101b
                      57     
A51 MACRO ASSEMBLER  PRACTICA4                                                            07/12/2021 07:52:05 PAGE     2

                      58     ;CONF SERIAL
                      59             
0046 115A             60             ACALL LCD_INICIALIZATION
                      61             
0048                  62     TEST:
                      63             ;PUEDEN UTILIZAR ESTE ESPACIO PARA PRUEBAS, SIEMPRE Y CUANDO DEJEN EL CODIGO COMO D
                             EBERÍA IR.
0048 7448             64             MOV A, #'H'
004A 1196             65             acall LCD_WRITE
                      66             
004C 7430             67             MOV A, #'0'
004E 1196             68             acall LCD_WRITE
                      69             
0050 744C             70             MOV A, #'L'
0052 1196             71             acall LCD_WRITE
                      72             
0054 7441             73             MOV A, #'A'
0056 1196             74             acall LCD_WRITE
                      75             
                      76             
                      77             
0058 80FE             78             SJMP $
                      79             
                      80             
005A                  81     LCD_INICIALIZATION:
                      82             ;38H - 39 us, RS = 0
                      83             ;0FH - 39 us, RS = 0
                      84             ;01H - 1.53 ms, RS = 0
005A C2B6             85             CLR RS; !COMANDO / DATO
005C C2B7             86             CLR E
005E 75A001           87             MOV P2, #01H
0061 7F11             88             MOV R7, #17D
0063 D2B7             89             SETB E ; E 
0065 11B9             90             ACALL DELAY
0067 C2B7             91             CLR E; E        
                      92     
0069 75A038           93             MOV P2, #38H
006C 7F01             94             MOV R7, #01h; cantidad de veces que se repite t_0
006E D2B7             95             SETB E; E 
0070 11B9             96             ACALL DELAY
0072 C2B7             97             CLR E; E
                      98             
0074 75A038           99             MOV P2, #38H
0077 7F01            100             MOV R7, #01h
0079 D2B7            101             SETB E ; E 
007B 11B9            102             ACALL DELAY
007D C2B7            103             CLR E; E
                     104             
007F 75A00F          105             MOV P2, #0FH
0082 7F01            106             MOV R7, #01h
0084 D2B7            107             SETB E; E 
0086 11B9            108             ACALL DELAY
0088 C2B7            109             CLR E; E
                     110     
008A 75A080          111             MOV P2, #80H
008D 7F01            112             MOV R7, #01h
008F D2B7            113             SETB E; E 
0091 11B9            114             ACALL DELAY
0093 C2B7            115             CLR E; E
                     116     
0095 22              117             RET
                     118             
0096                 119     LCD_WRITE:
                     120     ;PARA ESCRIBIR EN LCD, PASAR AL ACC EL CARACTER A ESCRIBIR
0096 BE1004          121             CJNE R6, #16D, LCD_WRITE_ACC
0099 11AB            122             ACALL LCD_JUMP
A51 MACRO ASSEMBLER  PRACTICA4                                                            07/12/2021 07:52:05 PAGE     3

009B 7E00            123             MOV R6, #0H
                     124             
009D                 125     LCD_WRITE_ACC:
009D D2B6            126             SETB RS; !COMANDO / DATO
009F F5A0            127             MOV P2, A; MOVER AL BUS DE LA PANTALLA EL DATO
00A1 D2B7            128             SETB E; E
00A3 7F01            129             MOV R7, #1
00A5 11B9            130             ACALL DELAY
00A7 C2B7            131             CLR E
00A9 0E              132             INC R6
                     133     
00AA 22              134             RET
                     135             
00AB                 136     LCD_JUMP:
00AB C2B6            137             CLR RS
00AD 75A0C0          138             MOV P2, #0C0H
00B0 D2B7            139             SETB E
00B2 7F01            140             MOV R7, #1D
00B4 11B9            141             ACALL DELAY
00B6 C2B7            142             CLR E
00B8 22              143             RET
                     144             
00B9                 145     DELAY:
00B9 758CFF          146             MOV TH0, #HIGH(-100)
00BC 758A9C          147             MOV TL0, #LOW(-100)
00BF D28C            148             SETB TR0
                     149             
00C1                 150     POOLING:
00C1 308DFD          151             JNB TF0, POOLING
00C4 C28D            152             CLR TF0
                     153             
00C6 DFF1            154             DJNZ R7, DELAY
                     155             
00C8 22              156             RET
                     157             
00C9 80FE            158             SJMP $
                     159             END
A51 MACRO ASSEMBLER  PRACTICA4                                                            07/12/2021 07:52:05 PAGE     4

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

DELAY. . . . . . .  C ADDR   00B9H   A   
DIR_CONVERTION . .  N NUMB   0050H   A   
DIR_DATOS. . . . .  N NUMB   0060H   A   
E. . . . . . . . .  B ADDR   00B0H.7 A   
IE . . . . . . . .  D ADDR   00A8H   A   
LCD_INICIALIZATION  C ADDR   005AH   A   
LCD_JUMP . . . . .  C ADDR   00ABH   A   
LCD_WRITE. . . . .  C ADDR   0096H   A   
LCD_WRITE_ACC. . .  C ADDR   009DH   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   
POOLING. . . . . .  C ADDR   00C1H   A   
RS . . . . . . . .  B ADDR   00B0H.6 A   
START. . . . . . .  C ADDR   0040H   A   
TEST . . . . . . .  C ADDR   0048H   A   
TF0. . . . . . . .  B ADDR   0088H.5 A   
TH0. . . . . . . .  D ADDR   008CH   A   
TL0. . . . . . . .  D ADDR   008AH   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
